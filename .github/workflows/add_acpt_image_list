name: Update ACPT Image File

# Copy image list file from ACPT ADO
on:
  push:
    paths:
      - '.azure_pipelines/pipeline_config/ptca_image_list.md'
  schedule:
  - cron: '0 0 1 * *'
jobs:
  copy-file:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout source repository
        uses: actions/checkout@v2

      - name: Checkout destination repository
        uses: actions/checkout@v2
        with:
          repository: destination-org/destination-repo
          token: ${{ secrets.REPO_ACCESS_TOKEN }}
          path: destination-repo

      - name: Copy file
        run: |
          git clone https://aiinfra.visualstudio.com/PyTorch/_git/ptebic?path=%2F&version=GBmain&_a=contents
          cp .azure_pipelines/pipeline_config/ptca_image_list.md onnexruntime/docs/ecosystem/ptca_image_list.md

      - name: Push changes
        run: |
          cd destination-repo
          git config user.name "GitHub Actions"
          git config user.email "actions@github.com"
          git add .
          git commit -m "Update ptca_image_list.md"
          git push
